<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
  <!-- Exclusions can be defined here and should include a comment on why the finding can be ignored -->
  <!--
  This lombok generated builder accepts an array which is ultimately given to the built instance
  constructor. This constructor processes the array to store individual fields. The array is not stored
  directly.
  -->
  <Match>
    <Class name="~.*Builder"/>
    <Or>
      <Bug pattern="EI_EXPOSE_REP"/>
      <Bug pattern="EI_EXPOSE_REP2"/>
    </Or>
  </Match>
  <!--
  To support local testing, we allow the vista.api.principal-file property to be overwritten by user input.
  In a real-world environment, the property will be loaded once on start from application.properties
  preventing user input from affecting application behavior.
   -->
  <Match>
  <Or>
    <Class name="gov.va.api.health.vistafhirquery.service.config.VistaApiConfig"/>
    <Class name="gov.va.api.health.vistafhirquery.service.config.RpcPrincipalConfig"/>
    <Class name="gov.va.api.health.vistafhirquery.service.config.RpcPrincipalV1Config"/>
  </Or>
    <Bug pattern="PATH_TRAVERSAL_IN"/>
  </Match>
</FindBugsFilter>
